#!/bin/bash
#//////////////////////////////////////////////////////////////////////////////
# AG Development Framework.
# Copyright 2011-2020 GeorgeAth. All Rights Reserved.
#//////////////////////////////////////////////////////////////////////////////

#//////////////////////////////////////////////////////////////////////////////

#//////////////////////////////////////////////////////////////////////////////
# Enviroment Variables
AG_BUILD_TYPE="Release"
AG_DIR_BUILD="build"
AG_DIR_LIB="AG-LIB"
AG_DIR_DEV="AG-DEV"
#//////////////////////////////////////////////////////////////////////////////

#//////////////////////////////////////////////////////////////////////////////
# Print current directory (source).
echo "Current directory (source) : $PWD"
#//////////////////////////////////////////////////////////////////////////////
# Change directory to root.
cd ../
echo "Current directory (root) : $PWD"
# Ensure required folders exist.
if [ ! -d "$AG_DIR_LIB" ]; then ( echo "lib not found." && exit 1 ) fi
if [ ! -d "$AG_DIR_DEV" ]; then ( echo "dev not found." && exit 1 ) fi
#//////////////////////////////////////////////////////////////////////////////
# Ensure build directory not exist.
if [ -d "$AG_DIR_BUILD" ]; then ( echo "build exist." && exit 1 ) fi
# Create build directory.
mkdir -p -- "$AG_DIR_BUILD"
# Change directory to build.
cd $AG_DIR_BUILD
echo "Current directory (build) : $PWD"
#//////////////////////////////////////////////////////////////////////////////

#//////////////////////////////////////////////////////////////////////////////
# Build the cmake-create command.
AG_CMAKE_CMD="cmake ../$AG_DIR_DEV"
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Print the cmake-create command.
echo "CMake Command : $AG_CMAKE_CMD"
#//////////////////////////////////////////////////////////////////////////////

# Ensure cmake is installed.
cmake --version

#//////////////////////////////////////////////////////////////////////////////
# Run the cmake-create command.
$AG_CMAKE_CMD
# Run the cmake-build command.
cmake --build . --config $AG_BUILD_TYPE
# Run the cmake-test command.
ctest -C $AG_BUILD_TYPE
#//////////////////////////////////////////////////////////////////////////////


#//////////////////////////////////////////////////////////////////////////////
#:EXIT_SCRIPT
# Exit this batch script with error level equal to 0.
exit 0
#//////////////////////////////////////////////////////////////////////////////
#:ABORT_OPERATION
#echo Operation aborted.
# Exit this batch script with error level equal to 1.
#exit 1
#//////////////////////////////////////////////////////////////////////////////
